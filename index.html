<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <script src="https://telegram.org/js/telegram-web-app.js?v=8.0"></script>
  <style>
    body { 
      background: #1a1a1a; 
      display: flex; 
      flex-direction: column; 
      align-items: center; 
      justify-content: center; 
      height: 100vh; 
      margin: 0; 
      color: white; 
      font-family: sans-serif; 
      overflow: hidden;
      touch-action: none;
    }

    #ball { 
      width: 300px; 
      height: 300px; 
      background: radial-gradient(circle at 30% 30%, #444, #000); 
      border-radius: 50%; 
      display: flex; 
      align-items: center; 
      justify-content: center; 
      position: relative; 
      box-shadow: 0 20px 50px rgba(0,0,0,0.9);
      transition: transform 0.1s ease-out;
	  will-change: transform, filter;
    }

    #window { 
      width: 170px; 
      height: 170px; 
      background: #020202; 
      border-radius: 50%; 
      border: 12px solid #222; 
      display: flex; 
      align-items: center; 
      justify-content: center; 
      position: relative;
      overflow: hidden; 
      box-shadow: inset 0 0 35px rgba(0,0,0,1);
    }

    #triangle-container {
    position: absolute;
    width: 240px; 
    height: 240px;
    display: flex;
    align-items: center;
    justify-content: center;
    /* –ü–æ–∫—Ä–∞—â–µ–Ω–∏–π –ø–µ—Ä–µ—Ö—ñ–¥ –¥–ª—è –µ—Ñ–µ–∫—Ç—É —Å–ø–ª–∏–≤–∞–Ω–Ω—è —É –≤'—è–∑–∫—ñ–π —Ä—ñ–¥–∏–Ω—ñ */
    transition: transform 0.3s ease-out, opacity 1.8s cubic-bezier(0.22, 1, 0.36, 1);
    will-change: transform, opacity;
}

#triangle {
    width: 220px;
    height: 190px;
    /* –°—Ñ–µ—Ä–∏—á–Ω–∏–π –≥—Ä–∞–¥—ñ—î–Ω—Ç —Å—Ç–≤–æ—Ä—é—î —ñ–ª—é–∑—ñ—é –≤–∏–ø—É–∫–ª–æ—ó –ø–æ–≤–µ—Ä—Ö–Ω—ñ */
    background: radial-gradient(circle at 50% 60%, #2a4fa3 0%, #1a3a8a 50%, #0e1e4d 100%);
    
    /* clip-path –∑ –∫—Ä–∏–≤–∏–º–∏ –ª—ñ–Ω—ñ—è–º–∏ –∑–∞–º—ñ—Å—Ç—å –≥–æ—Å—Ç—Ä–∏—Ö –ø—Ä—è–º–∏—Ö */
    /* –¶—è —Ñ—ñ–≥—É—Ä–∞ —ñ–º—ñ—Ç—É—î –ø—Ä–æ–µ–∫—Ü—ñ—é —Ç—Ä–∏–∫—É—Ç–Ω–∏–∫–∞ –Ω–∞ —Å—Ñ–µ—Ä—É */
    clip-path: polygon(50% 0%, 100% 85%, 85% 100%, 15% 100%, 0% 85%);
    /* –ë—ñ–ª—å—à —Ä–µ–∞–ª—ñ—Å—Ç–∏—á–Ω–∞ –≤–∏–≥–Ω—É—Ç–∞ —Ñ–æ—Ä–º–∞ —á–µ—Ä–µ–∑ –∫—É–±—ñ—á–Ω—ñ –∫—Ä–∏–≤—ñ (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞) */
    clip-path: path('M110 0 C140 60 220 150 220 170 C220 190 180 190 110 190 C40 190 0 190 0 170 C0 150 80 60 110 0 Z');
    
    position: relative;
    display: flex;
    justify-content: center;
    
    /* –¢—Ä–æ—Ö–∏ –ø—ñ–¥–Ω—ñ–º–∞—î–º–æ, —â–æ–± –∫—Ä–∞—ó —Ö–æ–≤–∞–ª–∏—Å—è –∑–∞ –≤—ñ–∫–Ω–æ–º */
    margin-top: -55px; 
    
    /* –¢—ñ–Ω—å —Ç–∞ –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ–π –≤—ñ–¥–±–ª–∏—Å–∫ */
    box-shadow: inset 0 -10px 20px rgba(0,0,0,0.5);
    filter: drop-shadow(0 0 12px rgba(0,0,0,0.8));
	
	position: relative;
    overflow: hidden;
}

/* –ï—Ñ–µ–∫—Ç –≥—Ä–∞–Ω—ñ (—Å–≤—ñ—Ç–ª–æ –Ω–∞ —Ä–µ–±—Ä–∞—Ö) */
#triangle::after {
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0; bottom: 0;
    background: linear-gradient(135deg, rgba(255,255,255,0.15) 0%, transparent 50%);
    pointer-events: none;
}

/* –®–∞—Ä –∑–µ—Ä–Ω–∏—Å—Ç–æ—Å—Ç—ñ */
#triangle::before {
    content: '';
    position: absolute;
    top: -50%; left: -50%; width: 200%; height: 200%;
    /* –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –≤—ñ–∑—É–∞–ª—å–Ω–æ–≥–æ —à—É–º—É */
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
    opacity: 0.15; /* –ù–∞—Å–∫—ñ–ª—å–∫–∏ —Å–∏–ª—å–Ω–æ –≤–∏–¥–Ω–æ –∑–µ—Ä–Ω–æ */
    pointer-events: none;
    mix-blend-mode: overlay;
}

#answer { 
    position: absolute;
    top: 85px; /* –ö–æ—Ä–∏–≥—É—î–º–æ –ø–æ–∑–∏—Ü—ñ—é –ø—ñ–¥ –Ω–æ–≤—É —Ñ–æ—Ä–º—É */
    color: #a8caff; 
    font-weight: bold; 
    font-size: 14px; 
    text-align: center;
    width: 110px;
    line-height: 1.1;
    text-transform: uppercase; 
    /* –¢–µ–∫—Å—Ç –Ω—ñ–±–∏ —Å–≤—ñ—Ç–∏—Ç—å—Å—è –∫—Ä—ñ–∑—å –≤–æ–¥—É */
    text-shadow: 0 0 8px rgba(127, 176, 255, 0.8);
    display: flex;
    align-items: center;
    justify-content: center;
    height: 70px;
    transform: perspective(100px) rotateX(10deg); /* –ù–∞—Ö–∏–ª —Ç–µ–∫—Å—Ç—É –¥–ª—è –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–∏ */
}

#answer.initial {
    font-size: 70px;
    top: 75px; 
    height: 90px;
    width: 100%;
    transform: none;
}

    .shake-anim { 
  animation: realisticShake 0.4s infinite alternate; 
  filter: blur(1px); /* –õ–µ–≥–∫–µ —Ä–æ–∑–º–∏—Ç—Ç—è –ø—Ä–∏ —Ä—É—Å—ñ */
}

@keyframes realisticShake {
  0% { 
    transform: translate(0, 0) rotate(0deg); 
  }
  25% { 
    transform: translate(8px, -4px) rotate(2deg); 
  }
  50% { 
    transform: translate(-10px, 6px) rotate(-3deg); 
  }
  75% { 
    transform: translate(6px, 10px) rotate(1.5deg); 
  }
  100% { 
    transform: translate(-4px, -8px) rotate(-1deg); 
  }
}

    #instruction {
      margin-top: 40px;
      font-size: 14px;
      text-align: center;
      padding: 0 20px;
      color: #888;
      max-width: 280px;
      line-height: 1.4;
    }

    #desktop-btn {
      margin-top: 30px;
      padding: 15px 45px;
      border-radius: 35px;
      border: none;
      background: linear-gradient(135deg, #4080ff, #1a3a8a);
      color: white;
      font-weight: bold;
      cursor: pointer;
      box-shadow: 0 4px 15px rgba(0,0,0,0.4);
    }
  </style>
</head>
<body>

  <div id="ball">
    <div id="window">
      <div id="triangle-container">
        <div id="triangle">
          <div id="answer" class="initial">?</div>
        </div>
      </div>
    </div>
  </div>

  <div id="instruction"></div>
  <button id="desktop-btn">–ü–û–¢–†–Ø–°–¢–ò üé±</button>

  <script>
    const tg = window.Telegram.WebApp;
    tg.ready();
    tg.expand();

    const answers = [
		"–ó–∞–ø–∏—Ç–∞–π –ø—ñ–∑–Ω—ñ—à–µ",
		"–¢–∞–∫, –±–µ–∑–ø–µ—Ä–µ—á–Ω–æ",
		"–ü–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–∏ –Ω–µ –¥—É–∂–µ –¥–æ–±—Ä—ñ",
		"–ú–æ–∂–µ—à –Ω–∞ —Ü–µ –ø–æ–∫–ª–∞—Å—Ç–∏—Å—è",
		"–ú–æ—è –≤—ñ–¥–ø–æ–≤—ñ–¥—å ‚Äî –Ω—ñ",
		"–¶–µ –±–µ–∑—Å—É–º–Ω—ñ–≤–Ω–æ",
		"–ù–∞—Ä–∞–∑—ñ –Ω–µ–º–æ–∂–ª–∏–≤–æ –ø–µ—Ä–µ–¥–±–∞—á–∏—Ç–∏",
		"–ó–Ω–∞–∫–∏ –≤–∫–∞–∑—É—é—Ç—å –Ω–∞ ¬´—Ç–∞–∫¬ª",
		"–î—É–∂–µ —Å—É–º–Ω—ñ–≤–Ω–æ",
		"–Ø–∫ –Ω–∞ –º–µ–Ω–µ ‚Äî —Ç–∞–∫",
		"–ó–æ—Å–µ—Ä–µ–¥—å—Å—è —ñ –∑–∞–ø–∏—Ç–∞–π –∑–Ω–æ–≤—É",
		"–¢–∞–∫",
		"–ú–æ—ó –¥–∂–µ—Ä–µ–ª–∞ –∫–∞–∂—É—Ç—å ¬´–Ω—ñ¬ª",
		"–ë–µ–∑ –∂–æ–¥–Ω–∏—Ö —Å—É–º–Ω—ñ–≤—ñ–≤",
		"–ë–∞—á–µ–Ω–Ω—è –Ω–µ—á—ñ—Ç–∫–µ, —Å–ø—Ä–æ–±—É–π —â–µ —Ä–∞–∑",
		"–ù–µ —Ä–æ–∑—Ä–∞—Ö–æ–≤—É–π –Ω–∞ —Ü–µ",
		"–ü–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–∏ —Ö–æ—Ä–æ—à—ñ",
		"–°–∞–º–µ —Ç–∞–∫",
		"–ö—Ä–∞—â–µ –Ω–µ –∫–∞–∑–∞—Ç–∏ —Ç–æ–±—ñ –∑–∞—Ä–∞–∑",
		"–ù–∞–π—ñ–º–æ–≤—ñ—Ä–Ω—ñ—à–µ"
    ];

    let isShaking = false;
    let resetTimer;
    const ball = document.getElementById('ball');
    const container = document.getElementById('triangle-container');
    const ansText = document.getElementById('answer');
    const instruction = document.getElementById('instruction');
    const btn = document.getElementById('desktop-btn');

    // 1. –õ–û–ì–Ü–ö–ê –°–ï–ù–°–û–†–Ü–í –ß–ï–†–ï–ó TELEGRAM API (v8.0+)
    function initTelegramSensors() {
      // –ê–∫—Å–µ–ª–µ—Ä–æ–º–µ—Ç—Ä –¥–ª—è —Ç—Ä—è—Å—ñ–Ω–Ω—è
      if (tg.Accelerometer) {
        tg.Accelerometer.start({ refresh_rate: 20 }, (success) => {
          if (success) {
            instruction.innerText = "–ó–æ—Å–µ—Ä–µ–¥—å—Å—è –Ω–∞ –ø–∏—Ç–∞–Ω–Ω—ñ —Ç–∞ –ø–æ—Ç—Ä—è—Å–∏ —Ç–µ–ª–µ—Ñ–æ–Ωüì±";
            
            tg.onEvent('accelerometerChanged', () => {
              const { x, y, z } = tg.Accelerometer;
              const totalAcc = Math.sqrt(x*x + y*y + z*z);
              
              // –Ø–∫—â–æ —Å–∏–ª–∞ —Ç—Ä—è—Å—ñ–Ω–Ω—è –±—ñ–ª—å—à–µ –ø–æ—Ä–æ–≥—É
              if (totalAcc > 22 && !isShaking) {
                shakeBall();
              }
            });
          }
        });
      }

      // –ì—ñ—Ä–æ—Å–∫–æ–ø –¥–ª—è –ø–ª–∞–≤–Ω–æ–≥–æ –Ω–∞—Ö–∏–ª—É —Ç—Ä–∏–∫—É—Ç–Ω–∏–∫–∞
      if (tg.DeviceOrientation) {
        tg.DeviceOrientation.start({ refresh_rate: 40 }, (success) => {
          if (success) {
            tg.onEvent('deviceOrientationChanged', () => {
              if (isShaking) return;
              const { gamma, beta } = tg.DeviceOrientation;
              // –ü–ª–∞–≤–Ω–µ –∑–º—ñ—â–µ–Ω–Ω—è —Ç—Ä–∏–∫—É—Ç–Ω–∏–∫–∞ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ
              const moveX = (gamma || 0) / 1.5;
              const moveY = (beta - 45) / 1.5;
              container.style.transform = `translate(${moveX}px, ${moveY}px)`;
            });
          }
        });
      }
    }

    function shakeBall() {
    if (isShaking) return;
    isShaking = true;
    clearTimeout(resetTimer);
    
    container.style.opacity = "0"; // –•–æ–≤–∞—î–º–æ —Ç—Ä–∏–∫—É—Ç–Ω–∏–∫
    ball.classList.add('shake-anim');

    if (tg.HapticFeedback) {
        tg.HapticFeedback.notificationOccurred('success');
    }

    setTimeout(() => {
        ball.classList.remove('shake-anim');
        
        // –í–∏–±–∏—Ä–∞—î–º–æ –≤—ñ–¥–ø–æ–≤—ñ–¥—å
        const randomAnswer = answers[Math.floor(Math.random() * answers.length)];
        ansText.innerText = randomAnswer;
        ansText.className = ""; 

        // --- –ü–û–ö–†–ê–©–ï–ù–ù–Ø –¢–£–¢ ---
        // –°—Ç–≤–æ—Ä—é—î–º–æ –≤–∏–ø–∞–¥–∫–æ–≤–∏–π "–Ω–µ—ñ–¥–µ–∞–ª—å–Ω–∏–π" –Ω–∞—Ö–∏–ª —Ç–∞ –∑–º—ñ—â–µ–Ω–Ω—è (–µ—Ñ–µ–∫—Ç –ø–ª–∞–≤–∞–Ω–Ω—è)
        const randomTilt = (Math.random() * 8 - 4); // –í—ñ–¥ -4 –¥–æ 4 –≥—Ä–∞–¥—É—Å—ñ–≤
        const randomShiftX = (Math.random() * 12 - 6); // –í—ñ–¥ -6px –¥–æ 6px
        const randomShiftY = (Math.random() * 10 - 5); // –í—ñ–¥ -5px –¥–æ 5px

        // –ó–∞—Å—Ç–æ—Å–æ–≤—É—î–º–æ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø–µ—Ä–µ–¥ –ø–æ—è–≤–æ—é
        container.style.transform = `translate(${randomShiftX}px, ${randomShiftY}px) rotate(${randomTilt}deg)`;
        
        // –ü–ª–∞–≤–Ω–∞ –ø–æ—è–≤–∞ –∑–∞–≤–¥—è–∫–∏ cubic-bezier —É CSS
        container.style.opacity = "1";
        // ----------------------

        isShaking = false;
        resetTimer = setTimeout(resetBall, 10000); // –°–∫–∏–¥–∞–Ω–Ω—è —á–µ—Ä–µ–∑ 10 —Å–µ–∫
    }, 800); // –¢—Ä–∏–≤–∞–ª—ñ—Å—Ç—å —Ç—Ä—è—Å—ñ–Ω–Ω—è
}

    function resetBall() {
      container.style.opacity = "0";
      setTimeout(() => {
        ansText.innerText = "?";
        ansText.className = "initial";
        container.style.opacity = "1";
      }, 600);
    }

    // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è
    const isMobile = ['android', 'ios'].includes(tg.platform);
    
    if (isMobile) {
      if (tg.version >= "8.0") {
        initTelegramSensors();
      } else {
        instruction.innerText = "–û–Ω–æ–≤—ñ—Ç—å Telegram –¥–ª—è —Ä–æ–±–æ—Ç–∏ —Å–µ–Ω—Å–æ—Ä—ñ–≤ –±–µ–∑ –¥–æ–∑–≤–æ–ª—ñ–≤.";
      }
    } else {
      instruction.innerText = "–ó–æ—Å–µ—Ä–µ–¥—å—Å—è –Ω–∞ –ø–∏—Ç–∞–Ω–Ω—ñ —Ç–∞ –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å –∫–Ω–æ–ø–∫—É.";
    }

    btn.onclick = shakeBall;

    // –ó—É–ø–∏–Ω–∫–∞ —Å–µ–Ω—Å–æ—Ä—ñ–≤ –ø—Ä–∏ –∑–∞–∫—Ä–∏—Ç—Ç—ñ –¥–ª—è –µ–∫–æ–Ω–æ–º—ñ—ó –±–∞—Ç–∞—Ä–µ—ó
    window.addEventListener('beforeunload', () => {
      if (tg.Accelerometer) tg.Accelerometer.stop();
      if (tg.DeviceOrientation) tg.DeviceOrientation.stop();
    });

  </script>
</body>
</html>
