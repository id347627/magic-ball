<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <script src="https://telegram.org/js/telegram-web-app.js?v=8.0"></script>
  <style>
    body { 
      background: #1a1a1a; 
      display: flex; 
      flex-direction: column; 
      align-items: center; 
      justify-content: center; 
      height: 100vh; 
      margin: 0; 
      color: white; 
      font-family: sans-serif; 
      overflow: hidden;
      touch-action: none;
    }

    #ball { 
      width: 300px; 
      height: 300px; 
      background: radial-gradient(circle at 30% 30%, #444, #000); 
      border-radius: 50%; 
      display: flex; 
      align-items: center; 
      justify-content: center; 
      position: relative; 
      box-shadow: 0 20px 50px rgba(0,0,0,0.9);
      will-change: transform;
    }

    #window { 
      width: 170px; 
      height: 170px; 
      background: #020202; 
      border-radius: 50%; 
      border: 12px solid #222; 
      display: flex; 
      align-items: center; 
      justify-content: center; 
      position: relative;
      overflow: hidden; 
      box-shadow: inset 0 0 35px rgba(0,0,0,1);
    }

    #triangle-container {
      position: absolute;
      width: 240px; 
      height: 240px;
      display: flex;
      align-items: center;
      justify-content: center;
      /* –ü–ª–∞–≤–Ω–∏–π –ø–µ—Ä–µ—Ö—ñ–¥ –¥–ª—è –µ—Ñ–µ–∫—Ç—É –ø–ª–∞–≤–∞–Ω–Ω—è */
      transition: transform 0.2s cubic-bezier(0.33, 1, 0.68, 1), opacity 1.8s ease-in-out;
      will-change: transform, opacity;
    }

    #triangle {
      width: 210px;
      height: 185px;
      background: radial-gradient(circle at 50% 60%, #2a4fa3 0%, #1a3a8a 50%, #0e1e4d 100%);
      
      /* –í–∏–≥–Ω—É—Ç–∞ —Ñ–æ—Ä–º–∞, —â–æ –ø–æ–≤—Ç–æ—Ä—é—î –≤–∏–≥–∏–Ω –∫—É–ª—ñ */
      clip-path: path('M105 5 C135 60 210 145 210 165 C210 185 170 185 105 185 C40 185 0 185 0 165 C0 145 75 60 105 5 Z');
      
      position: relative;
      display: flex;
      justify-content: center;
      
      /* –¶–µ–Ω—Ç—Ä—É–≤–∞–Ω–Ω—è –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ */
      margin-top: -10px; 
      
      filter: drop-shadow(0 0 10px rgba(0,0,0,0.8));
      overflow: hidden;
    }

    /* –®–∞—Ä –∑–µ—Ä–Ω–∏—Å—Ç–æ—Å—Ç—ñ (–ø–ª–∞—Å—Ç–∏–∫) */
    #triangle::before {
      content: '';
      position: absolute;
      top: -50%; left: -50%; width: 200%; height: 200%;
      background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
      opacity: 0.12;
      pointer-events: none;
      mix-blend-mode: overlay;
    }

    #triangle::after {
      content: '';
      position: absolute;
      top: 0; left: 0; right: 0; bottom: 0;
      background: linear-gradient(135deg, rgba(255,255,255,0.1) 0%, transparent 60%);
      pointer-events: none;
    }

    #answer { 
      position: absolute;
      top: 62px; 
      color: #a8caff; 
      font-weight: bold; 
      font-size: 14px; 
      text-align: center;
      width: 105px;
      line-height: 1.1;
      text-transform: uppercase; 
      text-shadow: 0 0 8px rgba(127, 176, 255, 0.8);
      display: flex;
      align-items: center;
      justify-content: center;
      height: 70px;
    }

    #answer.initial {
      font-size: 70px;
      top: 50px; 
      height: 90px;
      width: 100%;
    }

    .shake-anim { 
      animation: realisticShake 0.15s infinite alternate; 
      filter: blur(1px);
    }

    @keyframes realisticShake {
      0% { transform: translate(0, 0) rotate(0deg); }
      100% { transform: translate(10px, -8px) rotate(3deg); }
    }

    #instruction {
      margin-top: 40px;
      font-size: 14px;
      text-align: center;
      padding: 0 20px;
      color: #888;
      max-width: 280px;
      line-height: 1.4;
    }

    #desktop-btn {
      margin-top: 30px;
      padding: 15px 45px;
      border-radius: 35px;
      border: none;
      background: linear-gradient(135deg, #4080ff, #1a3a8a);
      color: white;
      font-weight: bold;
      cursor: pointer;
      box-shadow: 0 4px 15px rgba(0,0,0,0.4);
    }
  </style>
</head>
<body>

  <div id="ball">
    <div id="window">
      <div id="triangle-container">
        <div id="triangle">
          <div id="answer" class="initial">?</div>
        </div>
      </div>
    </div>
  </div>

  <div id="instruction"></div>
  <button id="desktop-btn">–ü–û–¢–†–Ø–°–¢–ò üé±</button>

  <script>
    const tg = window.Telegram.WebApp;
    tg.ready();
    tg.expand();

    const answers = [
        "–ó–∞–ø–∏—Ç–∞–π –ø—ñ–∑–Ω—ñ—à–µ", "–¢–∞–∫, –±–µ–∑–ø–µ—Ä–µ—á–Ω–æ", "–ü–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–∏ –Ω–µ –¥—É–∂–µ –¥–æ–±—Ä—ñ", "–ú–æ–∂–µ—à –Ω–∞ —Ü–µ –ø–æ–∫–ª–∞—Å—Ç–∏—Å—è",
        "–ú–æ—è –≤—ñ–¥–ø–æ–≤—ñ–¥—å ‚Äî –Ω—ñ", "–¶–µ –±–µ–∑—Å—É–º–Ω—ñ–≤–Ω–æ", "–ù–∞—Ä–∞–∑—ñ –Ω–µ–º–æ–∂–ª–∏–≤–æ –ø–µ—Ä–µ–¥–±–∞—á–∏—Ç–∏", "–ó–Ω–∞–∫–∏ –≤–∫–∞–∑—É—é—Ç—å –Ω–∞ ¬´—Ç–∞–∫¬ª",
        "–î—É–∂–µ —Å—É–º–Ω—ñ–≤–Ω–æ", "–Ø–∫ –Ω–∞ –º–µ–Ω–µ ‚Äî —Ç–∞–∫", "–ó–æ—Å–µ—Ä–µ–¥—å—Å—è —ñ –∑–∞–ø–∏—Ç–∞–π –∑–Ω–æ–≤—É", "–¢–∞–∫",
        "–ú–æ—ó –¥–∂–µ—Ä–µ–ª–∞ –∫–∞–∂—É—Ç—å ¬´–Ω—ñ¬ª", "–ë–µ–∑ –∂–æ–¥–Ω–∏—Ö —Å—É–º–Ω—ñ–≤—ñ–≤", "–ë–∞—á–µ–Ω–Ω—è –Ω–µ—á—ñ—Ç–∫–µ, —Å–ø—Ä–æ–±—É–π —â–µ —Ä–∞–∑",
        "–ù–µ —Ä–æ–∑—Ä–∞—Ö–æ–≤—É–π –Ω–∞ —Ü–µ", "–ü–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–∏ —Ö–æ—Ä–æ—à—ñ", "–°–∞–º–µ —Ç–∞–∫", "–ö—Ä–∞—â–µ –Ω–µ –∫–∞–∑–∞—Ç–∏ —Ç–æ–±—ñ –∑–∞—Ä–∞–∑", "–ù–∞–π—ñ–º–æ–≤—ñ—Ä–Ω—ñ—à–µ"
    ];

    let isShaking = false;
    let resetTimer;
    const ball = document.getElementById('ball');
    const container = document.getElementById('triangle-container');
    const ansText = document.getElementById('answer');
    const instruction = document.getElementById('instruction');
    const btn = document.getElementById('desktop-btn');

    function initTelegramSensors() {
      if (tg.Accelerometer) {
        tg.Accelerometer.start({ refresh_rate: 20 }, (success) => {
          if (success) {
            instruction.innerText = "–ó–æ—Å–µ—Ä–µ–¥—å—Å—è –Ω–∞ –ø–∏—Ç–∞–Ω–Ω—ñ —Ç–∞ –ø–æ—Ç—Ä—è—Å–∏ —Ç–µ–ª–µ—Ñ–æ–Ω üì±";
            tg.onEvent('accelerometerChanged', () => {
              const { x, y, z } = tg.Accelerometer;
              const totalAcc = Math.sqrt(x*x + y*y + z*z);
              if (totalAcc > 22 && !isShaking) shakeBall();
            });
          }
        });
      }

      if (tg.DeviceOrientation) {
        tg.DeviceOrientation.start({ refresh_rate: 40 }, (success) => {
          if (success) {
            tg.onEvent('deviceOrientationChanged', () => {
              if (isShaking) return;
              const { gamma, beta } = tg.DeviceOrientation;
              
              // –û–±–º–µ–∂—É—î–º–æ —Ä—É—Ö, —â–æ–± —Ç—Ä–∏–∫—É—Ç–Ω–∏–∫ –Ω–µ –≤–∏—Ö–æ–¥–∏–≤ –∑–∞–Ω–∞–¥—Ç–æ —Å–∏–ª—å–Ω–æ
              const moveX = (gamma || 0) / 2.5; 
              const moveY = (beta - 45) / 2.5; 
              
              container.style.transform = `translate(${moveX}px, ${moveY}px)`;
            });
          }
        });
      }
    }

    function shakeBall() {
      if (isShaking) return;
      isShaking = true;
      clearTimeout(resetTimer);
      
      container.style.opacity = "0";
      ball.classList.add('shake-anim');

      if (tg.HapticFeedback) tg.HapticFeedback.notificationOccurred('success');

      setTimeout(() => {
        ball.classList.remove('shake-anim');
        const randomAnswer = answers[Math.floor(Math.random() * answers.length)];
        ansText.innerText = randomAnswer;
        ansText.className = ""; 

        // –ï—Ñ–µ–∫—Ç "—Å–ø–ª–∏–≤–∞–Ω–Ω—è" —É –≤–∏–ø–∞–¥–∫–æ–≤–æ–º—É –ø–æ–ª–æ–∂–µ–Ω–Ω—ñ
        const randomTilt = (Math.random() * 6 - 3);
        const randomX = (Math.random() * 10 - 5);
        const randomY = (Math.random() * 8 - 4);

        container.style.transform = `translate(${randomX}px, ${randomY}px) rotate(${randomTilt}deg)`;
        container.style.opacity = "1";

        isShaking = false;
        resetTimer = setTimeout(resetBall, 15000);
      }, 800);
    }

    function resetBall() {
      container.style.opacity = "0";
      setTimeout(() => {
        ansText.innerText = "?";
        ansText.className = "initial";
        container.style.transform = "translate(0,0) rotate(0deg)";
        container.style.opacity = "1";
      }, 600);
    }

    if (['android', 'ios'].includes(tg.platform)) {
      if (tg.version >= "8.0") initTelegramSensors();
      else instruction.innerText = "–û–Ω–æ–≤—ñ—Ç—å Telegram –¥–ª—è —Ä–æ–±–æ—Ç–∏ —Å–µ–Ω—Å–æ—Ä—ñ–≤.";
    } else {
      instruction.innerText = "–ó–æ—Å–µ—Ä–µ–¥—å—Å—è –Ω–∞ –ø–∏—Ç–∞–Ω–Ω—ñ —Ç–∞ –Ω–∞—Ç–∏—Å–Ω–∏ –∫–Ω–æ–ø–∫—É.";
    }

    btn.onclick = shakeBall;
  </script>
</body>
</html>
