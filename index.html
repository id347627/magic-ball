<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <script src="https://telegram.org/js/telegram-web-app.js?v=8.0"></script>
  <style>
    body { 
      background: #1a1a1a; 
      display: flex; 
      flex-direction: column; 
      align-items: center; 
      justify-content: center; 
      height: 100vh; 
      margin: 0; 
      color: white; 
      font-family: sans-serif; 
      overflow: hidden;
      touch-action: none;
    }

    #ball { 
      width: 300px; 
      height: 300px; 
      background: radial-gradient(circle at 30% 30%, #444, #000); 
      border-radius: 50%; 
      display: flex; 
      align-items: center; 
      justify-content: center; 
      position: relative; 
      box-shadow: 0 20px 50px rgba(0,0,0,0.9);
      transition: transform 0.1s ease-out;
      will-change: transform, filter;
    }

    #window { 
      width: 170px; 
      height: 170px; 
      background: #020202; 
      border-radius: 50%; 
      border: 12px solid #222; 
      display: flex; 
      align-items: center; 
      justify-content: center; 
      position: relative;
      overflow: hidden; 
      box-shadow: inset 0 0 35px rgba(0,0,0,1);
    }

    #triangle-container {
      position: absolute;
      width: 180px; 
      height: 180px;
      display: flex;
      align-items: center;
      justify-content: center;
      /* Cubic-bezier —Å—Ç–≤–æ—Ä—é—î –µ—Ñ–µ–∫—Ç "—Å–ø–ª–∏–≤–∞–Ω–Ω—è" —É –≤'—è–∑–∫—ñ–π —Ä—ñ–¥–∏–Ω—ñ */
      transition: opacity 1.8s cubic-bezier(0.22, 1, 0.36, 1), transform 0.3s ease-out;
      will-change: transform, opacity;
    }

    #triangle {
      width: 175px; /* –†–æ–∑–º—ñ—Ä –ø—ñ–¥—ñ–±—Ä–∞–Ω–æ —Ç–∞–∫, —â–æ–± –∫—É—Ç–∏ —Ö–æ–≤–∞–ª–∏—Å—è –Ω–∞ ~5px */
      height: 165px;
      background: radial-gradient(circle at 50% 60%, #1e3d2b 0%, #142b1e 50%, #0a140e 100%);
	  
      /* –ü–æ–∫—Ä–∞—â–µ–Ω–∏–π —à–ª—è—Ö –∑ –≤–∏–≥–Ω—É—Ç–∏–º–∏ —Å—Ç–æ—Ä–æ–Ω–∞–º–∏ —Ç–∞ –∑–≥–ª–∞–¥–∂–µ–Ω–∏–º–∏ –∫—É—Ç–∞–º–∏ */
      clip-path: path('M87.5 5 C110 50 175 130 175 145 C175 160 140 160 87.5 160 C35 160 0 160 0 145 C0 130 65 50 87.5 5 Z');
      
      position: relative;
      display: flex;
      justify-content: center;
      align-items: center;
      
      box-shadow: inset 0 -10px 20px rgba(0,0,0,0.5);
      filter: drop-shadow(0 0 12px rgba(0,0,0,0.8));
      overflow: hidden;
    }

    /* –ó–µ—Ä–Ω–∏—Å—Ç—ñ—Å—Ç—å –ø–ª–∞—Å—Ç–∏–∫—É */
    #triangle::before {
      content: '';
      position: absolute;
      top: -50%; left: -50%; width: 200%; height: 200%;
      background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
      opacity: 0.12;
      pointer-events: none;
      mix-blend-mode: overlay;
    }

    #answer { 
      position: absolute;
      top: 70px;
      color: #a8caff; 
      font-weight: bold; 
      font-size: 14px; 
      text-align: center;
      width: 100px;
      line-height: 1.1;
      text-transform: uppercase; 
      text-shadow: 0 0 8px rgba(127, 176, 255, 0.8);
      display: flex;
      align-items: center;
      justify-content: center;
      height: 60px;
      transform: perspective(100px) rotateX(10deg);
    }

    #answer.initial {
      font-size: 70px;
      top: 60px; 
      height: 80px;
      width: 100%;
      transform: none;
    }

    .shake-anim { 
      animation: realisticShake 0.4s infinite alternate; 
      filter: blur(1px);
    }

    @keyframes realisticShake {
      0% { transform: translate(0, 0) rotate(0deg); }
      25% { transform: translate(8px, -4px) rotate(2deg); }
      50% { transform: translate(-10px, 6px) rotate(-3deg); }
      75% { transform: translate(6px, 10px) rotate(1.5deg); }
      100% { transform: translate(-4px, -8px) rotate(-1deg); }
    }

    #instruction {
      margin-top: 40px;
      font-size: 14px;
      text-align: center;
      padding: 0 20px;
      color: #888;
      max-width: 280px;
      line-height: 1.4;
    }

    #desktop-btn {
      margin-top: 30px;
      padding: 15px 45px;
      border-radius: 35px;
      border: none;
      background: linear-gradient(135deg, #1e3d2b, #0a140e);	  
      color: white;
      font-weight: bold;
      cursor: pointer;
      box-shadow: 0 4px 15px rgba(0,0,0,0.4);
    }
  </style>
</head>
<body>

  <div id="ball">
    <div id="window">
      <div id="triangle-container">
        <div id="triangle">
          <div id="answer" class="initial">?</div>
        </div>
      </div>
    </div>
  </div>

  <div id="instruction"></div>
  <button id="desktop-btn">–ü–û–¢–†–Ø–°–¢–ò üé±</button>

  <script>
    const tg = window.Telegram.WebApp;
    tg.ready();
    tg.expand();

    const answers = [
      "–ó–∞–ø–∏—Ç–∞–π –ø—ñ–∑–Ω—ñ—à–µ", "–¢–∞–∫, –±–µ–∑–ø–µ—Ä–µ—á–Ω–æ", "–ù–µ –¥—É–∂–µ –¥–æ–±—Ä—ñ –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–∏ ",
      "–ú–æ–∂–µ—à –Ω–∞ —Ü–µ –ø–æ–∫–ª–∞—Å—Ç–∏—Å—è", "–ú–æ—è –≤—ñ–¥–ø–æ–≤—ñ–¥—å ‚Äî –Ω—ñ", "–¶–µ –±–µ–∑—Å—É–º–Ω—ñ–≤–Ω–æ",
      "–ù–∞—Ä–∞–∑—ñ –Ω–µ–º–æ–∂–ª–∏–≤–æ –ø–µ—Ä–µ–¥–±–∞—á–∏—Ç–∏", "–ó–Ω–∞–∫–∏ –≤–∫–∞–∑—É—é—Ç—å –Ω–∞ ¬´—Ç–∞–∫¬ª", "–î—É–∂–µ —Å—É–º–Ω—ñ–≤–Ω–æ",
      "–Ø–∫ –Ω–∞ –º–µ–Ω–µ ‚Äî —Ç–∞–∫", "–ó–æ—Å–µ—Ä–µ–¥—å—Å—è —ñ –∑–∞–ø–∏—Ç–∞–π –∑–Ω–æ–≤—É", "–¢–∞–∫",
      "–ú–æ—ó –¥–∂–µ—Ä–µ–ª–∞ –∫–∞–∂—É—Ç—å ¬´–Ω—ñ¬ª", "–ë–µ–∑ –∂–æ–¥–Ω–∏—Ö —Å—É–º–Ω—ñ–≤—ñ–≤", "–ë–∞—á–µ–Ω–Ω—è –Ω–µ—á—ñ—Ç–∫–µ",
      "–ù–µ —Ä–æ–∑—Ä–∞—Ö–æ–≤—É–π –Ω–∞ —Ü–µ", "–•–æ—Ä–æ—à—ñ –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–∏", "–°–∞–º–µ —Ç–∞–∫",
      "–ö—Ä–∞—â–µ –Ω–µ –∫–∞–∑–∞—Ç–∏ —Ç–æ–±—ñ –∑–∞—Ä–∞–∑", "–ù–∞–π—ñ–º–æ–≤—ñ—Ä–Ω—ñ—à–µ"
    ];

    let isShaking = false;
    let resetTimer;
    let targetX = 0, targetY = 0;
    let currentX = 0, currentY = 0;
    let currentTilt = 0;

    const ball = document.getElementById('ball');
    const container = document.getElementById('triangle-container');
    const ansText = document.getElementById('answer');
    const instruction = document.getElementById('instruction');
    const btn = document.getElementById('desktop-btn');

    function initTelegramSensors() {
      if (tg.Accelerometer) {
        tg.Accelerometer.start({ refresh_rate: 20 }, (success) => {
          if (success) {
            instruction.innerText = "–ó–æ—Å–µ—Ä–µ–¥—å—Å—è –Ω–∞ –ø–∏—Ç–∞–Ω–Ω—ñ —Ç–∞ –ø–æ—Ç—Ä—è—Å–∏ —Ç–µ–ª–µ—Ñ–æ–Ωüì±";
            tg.onEvent('accelerometerChanged', () => {
              const { x, y, z } = tg.Accelerometer;
              const totalAcc = Math.sqrt(x*x + y*y + z*z);
              if (totalAcc > 22 && !isShaking) shakeBall();
            });
          }
        });
      }

      if (tg.DeviceOrientation) {
        tg.DeviceOrientation.start({ refresh_rate: 40 }, (success) => {
          if (success) {
            tg.onEvent('deviceOrientationChanged', () => {
              if (isShaking) return;
              const { gamma, beta } = tg.DeviceOrientation;
              // –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –∑–º—ñ—â–µ–Ω–Ω—è (–æ–±–º–µ–∂–µ–Ω–æ —á–∞—à–µ—é –≤—ñ–∫–Ω–∞)
              targetX = (gamma || 0) / 1.5;
              targetY = (beta - 45) / 1.5;
            });
          }
        });
      }
    }

    // –ê–Ω—ñ–º–∞—Ü—ñ–π–Ω–∏–π —Ü–∏–∫–ª –¥–ª—è –ø–ª–∞–≤–Ω–æ–≥–æ –ø–ª–∞–≤–∞–Ω–Ω—è
    function animate() {
      if (!isShaking) {
        // –õ–µ–≥–∫–∞ —ñ–Ω–µ—Ä—Ü—ñ—è (smoothing)
        currentX += (targetX - currentX) * 0.1;
        currentY += (targetY - currentY) * 0.1;
        
        // –î–æ–¥–∞—î–º–æ –º—ñ–∫—Ä–æ-–ø–ª–∞–≤–∞–Ω–Ω—è (–±–ª—É–∫–∞–Ω–Ω—è –≤ —Ä—ñ–¥–∏–Ω—ñ)
        const drift = Math.sin(Date.now() / 1000) * 2;
        
        container.style.transform = `translate(${currentX}px, ${currentY + drift}px) rotate(${currentTilt}deg)`;
      }
      requestAnimationFrame(animate);
    }

    function shakeBall() {
      if (isShaking) return;
      isShaking = true;
      clearTimeout(resetTimer);
      
      container.style.opacity = "0";
      ball.classList.add('shake-anim');

      if (tg.HapticFeedback) tg.HapticFeedback.notificationOccurred('success');

      setTimeout(() => {
        ball.classList.remove('shake-anim');
        ansText.innerText = answers[Math.floor(Math.random() * answers.length)];
        ansText.className = ""; 

        // –í–∏–ø–∞–¥–∫–æ–≤–∏–π –∫—É—Ç –∑—É–ø–∏–Ω–∫–∏ –¥–ª—è —Ä–µ–∞–ª—ñ–∑–º—É
        currentTilt = (Math.random() * 10 - 5); 
        
        container.style.opacity = "1";
        isShaking = false;
        
        resetTimer = setTimeout(resetBall, 10000);
      }, 800);
    }

    function resetBall() {
      container.style.opacity = "0";
      setTimeout(() => {
        ansText.innerText = "?";
        ansText.className = "initial";
        currentTilt = 0;
        container.style.opacity = "1";
      }, 600);
    }

    const isMobile = ['android', 'ios'].includes(tg.platform);
    if (isMobile && tg.version >= "8.0") {
      initTelegramSensors();
    } else if (!isMobile) {
      instruction.innerText = "–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –∫–Ω–æ–ø–∫—É, —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—å";
    }

    btn.onclick = shakeBall;
    animate();

    window.addEventListener('beforeunload', () => {
      if (tg.Accelerometer) tg.Accelerometer.stop();
      if (tg.DeviceOrientation) tg.DeviceOrientation.stop();
    });
  </script>
</body>
</html>
